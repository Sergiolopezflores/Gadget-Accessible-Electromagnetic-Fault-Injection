# 3 EM-SENSE Prototyping for Electromagnetic Data Acquisition
The development of EM-SENSE, a prototype for electromagnetic (EM) data acquisition, is central to our research. This device has been specifically designed to capture EM signals generated by computing systems during the execution of various software types. Utilizing the Arduino UNO R4 WiFi platform as the foundational component [13], EM-SENSE operates as an adaptable and efficient tool for real-time monitoring and remote control of EM emissions in computing environments. This section details the prototype’s hardware composition and configuration process, which are critical for achieving the high sensitivity and precision required for our study. Figure 5 shows an image of the complete setup of EM-SENSE, in which each component can be seen and is described in further detail below.

![Logo del proyecto](images/EM-SENSE gadte.jpg)


# 3.1 Hardware Configuration
The Arduino UNO R4 WiFi board [13] is the core processing unit of EM-SENSE due to its versatility and performance capabilities, chosen for its processing power and wireless capabilities (shown in figure 3b). This hardware is equipped with the Renesas RA4M1 32-bit microcontroller (ARM Cortex M4 architecture), this board operates at a frequency of 48 MHz and offers ample memory resources (32 kB of SRAM and 256 kB of flash) [14]. The board supports multiple communication protocols, including UART, I2C, and SPI, facilitating flexible connectivity with peripheral components [13] (see figure 3a. WiFi and Bluetooth modules (ESP32-S3) enabling wireless monitoring and remote system control via the Arduino IoT Cloud platform are included [15]. 
The EM-SENSE prototype integrates an SD card module [16] (in figure 4b) and a 16x2 LCD display module (LCM1602C) [17] for autonomous data storage and real-time signal visualization, shown in figure 4a. The SD module enables data recording on microSDHC cards, ensuring a high capacity (up to 32 GB) for prolonged testing sessions. 
The LCD display provides instant feedback on detected signal intensity, enabling the identification of potential anomalies during measurement without requiring external interfacing. LCD Screen displays real-time relevant information about the system. On one hand, it shows the results of the preliminary check on the SD card reader module, confirming that there are no access
issues. On the other hand, it provides real-time data obtained from the system,
allowing us to detect any potential errors, such as zero-value measurements.
Below, we outline the different messages that may appear on the LCD screen:

Figure 2: Overview of the EM-SENSE setup, displaying each component included in the gadget configuration

# 3.2 Near-Field Probe Design and Placement
To achieve optimal sensitivity for detecting low-intensity EM signals, a nearfield probe 4c was incorporated into the EM-SENSE design [18]. The probe, replacing a conventional wire antenna, is critical for isolating and capturing lowlevel emissions, which are characteristic of computing environments. This nearfield probe has been strategically positioned relative to the central processing unit (CPU) of the target system, based on a placement study that maximized signal quality by reducing noise and interference [19]. This configuration allows for precise EM measurement in proximity to potential sources of EM variation, such as processor and memory components, which may reveal patterns related to specific software activities, including malware behavior [20].

# 3.3 Physical and Electrical Stabilization
The EM-SENSE prototype utilizes a protoboard for stable component arrangement and flexible circuit modifications [21]. This setup allows the rapid reconfiguration of elements, such as the LCD display and SD module, without permanent soldering, facilitating adjustments during the testing phase. The protoboard also supports the physical stabilization of components, essential for minimizing signal disruption caused by movement or electrical instability. To further ensure accurate readings, the system includes safeguards against ambient EM interference, such as grounding strategies and shielding, tailored to the near-field probe’s requirements [22].

(a) Pinout diagram of the Arduino
UNO R4 WiFi, displaying the layout
and functionalities of each pin, essential for the configuration of the EMSENSE prototype.
(b) Arduino UNO R4 WiFi board used
as the core of the EM-SENSE prototype, chosen for its processing power
and wireless capabilities.
Figure 3: Images of the Arduino UNO R4 WiFi board and its pinout diagram,
essential components of the EM-SENSE prototype setup.

# 3.4 Data Processing and Storage
Data captured by EM-SENSE is stored in real-time on the SD card module, allowing subsequent analysis with advanced signal processing techniques. This method ensures the integrity and availability of large datasets without interruption, supporting in-depth investigations of EM emissions over extended periods. The data recorded is primarily intended to capture deviations in EM patterns, which may correlate with specific software-induced activities, particularly those indicative of malware. Through data visualization on the integrated LCD, preliminary trends and anomalies can be assessed immediately, streamlining the identification of relevant signal features during testing.

# 3.5 Summary of Design Adaptations for Research Objectives
Although EM-SENSE is based on a previously established design, substantial modifications have been made to meet the specific objectives of this research. Enhancements in signal sensitivity, data handling, and measurement precision ensure that the prototype meets the stringent requirements for detecting subtle EM variations associated with software execution. The device’s adaptability, facilitated by its modular design and the Arduino platform, makes EM-SENSE a highly suitable tool for controlled EM monitoring, enabling the identification of patterns potentially linked to malicious activity within computing systems.

(a) AZDelivery SPI SD
card module.
(b) LCD display module
(LCM1602C). (c) Near-field probes.
Figure 4: Components of the EM-SENSE system: (a) SPI SD card module, (b)
LCD display, and (c) near-field probes.
